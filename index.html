<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Image Studio</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">
</head>

<body>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js');
            });
        }
    </script>
    <div class="container">
        <aside class="sidebar">
            <div class="logo">Gemini Image Studio</div>
            <nav class="nav-tabs">
                <div class="nav-tab active" data-tab="text-to-image">
                    <span>üé®</span> –¢–µ–∫—Å—Ç –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                </div>
                <div class="nav-tab" data-tab="image-editing">
                    <span>‚ú®</span> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                </div>
                <div class="nav-tab" data-tab="multi-turn">
                    <span>üí¨</span> –ß–∞—Ç-—Å–µ—Å—Å–∏—è
                </div>
                <div class="nav-tab" data-tab="reference">
                    <span>üñºÔ∏è</span> –ü–æ –æ–±—Ä–∞–∑—Ü–∞–º
                </div>
                <div class="nav-tab" data-tab="grounding">
                    <span>üîç</span> –ü–æ–∏—Å–∫ Google
                </div>
            </nav>

            <!-- Sidebar Settings -->
            <div style="margin-top: 2rem; border-top: 1px solid var(--glass-border); padding-top: 1rem;">
                <h3 style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 1rem;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</h3>

                <div class="form-group">
                    <label>–ú–æ–¥–µ–ª—å</label>
                    <select id="tti-model">
                        <option value="gemini-3-pro-image-preview">NanoBananaPro (Pro)</option>
                        <option value="gemini-2.5-flash-image">NanoBanana (Flash)</option>
                        <option value="imagen-3.0-generate-002">Imagen 3.0</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ</label>
                    <select id="tti-aspect">
                        <option value="1:1">1:1 (Square)</option>
                        <option value="16:9">16:9 (Landscape)</option>
                        <option value="9:16">9:16 (Portrait)</option>
                        <option value="4:3">4:3</option>
                        <option value="3:2">3:2</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>–ö–∞—á–µ—Å—Ç–≤–æ</label>
                    <select id="tti-res">
                        <option value="hd">HD (Standard)</option>
                        <option value="fhd">Full HD (High)</option>
                        <option value="2k">2K (Ultra)</option>
                        <option value="4k">4K (Max)</option>
                    </select>
                </div>
            </div>

            <div style="margin-top: auto;">
                <label>API –ö–ª—é—á</label>
                <input type="password" id="api-key" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á...">
            </div>
        </aside>

        <main class="content">
            <div class="api-badge">
                <div class="status-dot" id="status-dot"></div>
                <span id="status-text">–°–∏–º—É–ª—è—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞</span>
            </div>

            <!-- Text to Image Tab -->
            <section id="text-to-image" class="tab-panel active">
                <h2>–¢–µ–∫—Å—Ç –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
                <p class="subtitle">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —à–µ–¥–µ–≤—Ä—ã –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π.</p>

                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ (Prompt)</label>
                    <textarea id="tti-prompt" placeholder="–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–≤–∏–¥–µ—Ç—å..."></textarea>
                </div>

                <button class="btn" onclick="generate('text-to-image')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </section>

            <!-- Image Editing Tab -->
            <section id="image-editing" class="tab-panel">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Inpainting)</h2>
                <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –∏ –∑–∞–∫—Ä–∞—Å—å—Ç–µ –æ–±–ª–∞—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å.</p>

                <div class="form-group">
                    <label>–ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                    <div class="file-drop-zone" onclick="document.getElementById('edit-image-file').click()">
                        –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª
                        <input type="file" id="edit-image-file" hidden accept="image/*">
                    </div>
                </div>

                <!-- Canvas Editor -->
                <div class="form-group" id="canvas-container" style="display:none;">
                    <label>–°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å–∫–∏ (—Ä–∏—Å—É–π—Ç–µ –ø–æ–≤–µ—Ä—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)</label>
                    <div class="editor-wrapper"
                        style="position: relative; width: 100%; max-width: 512px; margin: 0 auto; border: 1px solid var(--glass-border); border-radius: 8px; overflow: hidden; touch-action: none;">
                        <img id="edit-source-img"
                            style="display: block; width: 100%; height: auto; pointer-events: none;">
                        <canvas id="mask-canvas"
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: crosshair;"></canvas>
                    </div>

                    <div class="canvas-controls"
                        style="display: flex; gap: 10px; margin-top: 10px; align-items: center; justify-content: center;">
                        <label style="margin:0; font-size: 0.8rem;">–ö–∏—Å—Ç—å:</label>
                        <input type="range" id="brush-size" min="5" max="50" value="20" style="width: 100px;">
                        <button class="btn-micro" onclick="clearMask()"
                            style="background: var(--bg-tertiary); border: 1px solid var(--glass-border);">üßπ –°—Ç–µ—Ä–µ—Ç—å
                            –º–∞—Å–∫—É</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å? (Prompt)</label>
                    <textarea id="edit-prompt"
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤—å —Ñ—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—á–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂—É..."></textarea>
                </div>

                <button class="btn" onclick="generate('image-editing')">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </section>

            <!-- Context Mode (ex. Multi-turn) -->
            <section id="multi-turn" class="tab-panel">
                <h2>–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π —Ä–µ–∂–∏–º</h2>
                <p class="subtitle">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –ø–∞–º—è—Ç—å—é: –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</p>

                <!-- Hidden Chat History (Removed visual clutter) -->

                <div class="form-group">
                    <label>–í–∞—à –∑–∞–ø—Ä–æ—Å</label>
                    <textarea id="chat-msg" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–¥–µ–ª–∞–π –µ–≥–æ –≤ —Å—Ç–∏–ª–µ –∫–∏–±–µ—Ä–ø–∞–Ω–∫..."></textarea>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>–°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Ñ–æ—Ç–æ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                        <input type="file" id="chat-attachment" accept="image/*">
                    </div>
                    <div class="form-group">
                        <!-- Placeholder for future options -->
                    </div>
                </div>

                <button class="btn" onclick="generate('multi-turn')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </section>

            <!-- Reference Images Tab -->
            <section id="reference" class="tab-panel">
                <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ –æ–±—Ä–∞–∑—Ü–∞–º</h2>
                <p class="subtitle">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ 14 —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å—Ç–∏–ª—è –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è.</p>

                <div class="form-group">
                    <label>–≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <div class="file-drop-zone" onclick="document.getElementById('ref-files').click()">
                        –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ 14 —Ñ–∞–π–ª–æ–≤...
                        <input type="file" id="ref-files" multiple hidden accept="image/*">
                    </div>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn-micro" id="clear-ref-btn"
                            style="background: transparent; border: 1px solid var(--glass-border); color: var(--text-muted); padding: 4px 10px; font-size: 0.8rem;">
                            ‚ùå –°–±—Ä–æ—Å–∏—Ç—å
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (Prompt)</label>
                    <textarea id="ref-prompt"
                        placeholder="–û–ø–∏—à–∏—Ç–µ, –∫–∞–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å—Ç–∏–ª–∏ —ç—Ç–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π..."></textarea>
                </div>

                <button class="btn" onclick="generate('reference')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </section>

            <!-- Grounding Tab -->
            <section id="grounding" class="tab-panel">
                <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –ø–æ–∏—Å–∫–æ–º Google</h2>
                <p class="subtitle">–ü–æ–≤—ã—à–∞–π—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–∞–ª–µ–π —Å –ø–æ–º–æ—â—å—é Google Search Grounding.</p>

                <div class="form-group">
                    <label>–¢–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</label>
                    <textarea id="ground-prompt"
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ñ–æ—Ç–æ –≠–π—Ñ–µ–ª–µ–≤–æ–π –±–∞—à–Ω–∏ –Ω–∞ –∑–∞–∫–∞—Ç–µ —Å —É—á–µ—Ç–æ–º —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã..."></textarea>
                </div>

                <div class="form-group" style="display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="use-search" checked>
                    <label for="use-search" style="margin-bottom: 0;">–í–∫–ª—é—á–∏—Ç—å –ø–æ–∏—Å–∫ Google (Google Search
                        Grounding)</label>
                </div>

                <button class="btn" onclick="generate('grounding')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </section>

            <!-- Results Section -->
            <div class="result-area">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                    <div id="loading-spinner" style="display: none; color: var(--primary);">‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...</div>
                </div>
                <div class="preview-container" id="result-preview">
                    –ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>

</html>